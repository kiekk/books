## 6장 스텁을 활용한 포괄적인 테스트

```markdown
특정 런타임 환경에 의존적인 애플리케이션을 단위 테스트하는 것은 꽤나 고된일일 것이다.
테스트는 안정적이어야 하고, 반복적으로 수행해도 매번 동일한 결과를 내야 한다.
따라서 테스트를 올바로 수행하기 위해서는 환경을 제어할 수 있어야 한다.
```

### 6.1 스텁이란?

```markdown
스텁은 실제 코드나 아직 준비되지 못한 코드의 행동으로 가장하는 메커니즘을 말한다.
스텁을 사용하면 시스템의 특정 부분이 미처 준비되지 못했더라도 다른 부분을 테스트할 수 있다.
보통 스텁은 대상 코드에 손을 대지 않으면서 매끄럽게 통합된다는 장점이 있다.

[정의]
스텁이란 호출자를 실제 구현물로부터 격리시킬 목적으로 런타임에 실제 코드 대신 삽입되는 코드 조각이다.
복잡한 행위를 단순한 것으로 교체하여 실 코드의 일부를 독립적으로 테스트하기 위한 용도로 사용된다.

다음과 같은 경우에 스텁을 활용할 수 있다.
- 시스템이 너무 복잡하고 깨지기 쉬워 수정이 불가할 때
- 하부 시스템 간의 통합 테스트처럼 포괄적인 테스트를 수행할 때

...

스텁은 대체하려는 코드와 동일한 로직을 갖춰야 하므로, 복잡한 로직에 맞추는 것은 그만큼 힘들게 마련이다.
여기 스텁의 단점을 열거해 보았다.
- 제작이 복잡하여 스텁 자체를 디버깅하는 상황도 종종 발생한다.
- 그 복잡성 때문에 유지보수가 어려울 수 있다.
- 상세한(fine-grained) 테스트에는 적합하지 못한다.
- 상황에 따라 다른 스텁 정책이 요구된다.

일반적으로, 스텁은 포괄적인 코드 블록을 대체하는데 더 적합하다.
즉 스텁은 파일 시스템이나, 서버와의 커넥션, 데이터베이스 등 외부 시스템 전체를 대체하는데 주로 활용된다.
```
