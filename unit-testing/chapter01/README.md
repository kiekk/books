## 1장. 단위 테스트 목표

```markdown
단위 테스트를 배우는 것은 테스트 프레임워크나 목 라이브러리 등과 같은 기술적인 부분을 익히는 것에 그치지 않는다.
단위 테스트는 단순히 테스트를 작성하는 것 보다 더 큰 범주다.
```

### 1.1 단위 테스트 현황

```markdown
논쟁은 '단위 테스트를 작성해야 하는가?'에서 '좋은 단위 테스트를 작성하는 것은 어떤 의미인가?'로 바뀌었다.
이는 여전히 매우 혼란스럽다.
```

### 1.2 단위 테스트의 목표

```markdown
단위 테스트의 목표는 무엇인가?
소프트웨어 프로젝트의 지속 가능한 성장을 가능하게 하는 것이다.
지속 가능하다는 것이 핵심이다.
...
테스트는 초반에 노력(어쩌면 상당한 노력)이 필요하다는 것이다.
...
코드베이스를 지속적으로 검증하는 테스트 없이는 소프트웨어 개발이 쉽게 확장되지 않는다.
지속성과 확장성이 핵심이며, 이를 통해 장기적으로 개발 속도를 유지할 수 있다.
```

#### 1.2.1 좋은 테스트와 좋지 않은 테스트를 가르는 요인

```markdown
단위 테스트가 프로젝트 성장에 도움이 되는 것은 맞지만, 테스트를 작성하는 것만으로는 충분하지 않다.
잘못 작성한 테스트는 여전히 같은 결과를 낳는다.
...
모든 테스트를 작성할 필요는 없다.
...
프로젝트에 도움이 되는지 여부를 명확하게 파악하지 않고 단위 테스트를 작성하는 데만 빠져들기 쉽다.
```

### 1.3 테스트 스위트 품질 측정을 위한 커버리지 지표

```markdown
일반적으로 커버리지 숫자가 높을수록 더 좋다.
안타깝게도 그렇게 간단하지만은 않다.
커버리지 지표는 중요한 피드백을 주더라도 테스트 스위트 품질을 효과적으로 측정하는 데 사용될 수 없다.
코드를 단위 테스트하는 것과 같은 상황이다.
즉, 커버리지 지표는 괜찮은 부정 지표이지만 좋지 않은 긍정 지표다.
코드 커버리지가 너무 적을 때는(예를 들면, 10%) 테스트가 충분치 않다는 증거다.
그러나 반대의 경우는 그렇지 못하다.
100% 커버리지라고 해서 반드시 양질의 테스트 스위트라고 보장하지는 않는다.
높은 커버리지의 테스트 스위트도 품질이 떨어질 수 있다.
```

#### 1.3.3 커버리지 지표에 관한 문제점

```markdown
분기 커버리지로 코드 커버리지보다 더 나은 결과를 얻을 수 있지만, 테스트 스위트의 품질을 결정하는 데 어떤 커버리지 지표도 의존할 수 없는 이유는 다음과 같다.
- 테스트 대상 시스템의 모든 가능한 결과를 검증한다고 보장할 수 없다.
- 외부 라이브러리의 코드 경로를 고려할 수 있는 커버리지 지표는 없다.
```

#### 1.3.4 특정 커버리지 숫자를 목표로 하기

```markdown
100%, 90%, 심지어 중간 정도인 70%까지 특정 커버리지 숫자를 목표로 삼기 시작하면 위험 영역으로 이어질 수 있다.
커버리지 지표를 보는 가장 좋은 방법은 지표 그 자체로 보는 것이며, 목표로 여겨서는 안 된다.
...
특정 커버리지 숫자를 목표로 하는 것은 단위 테스트의 목표와 반대되는 그릇된 동기 부여가 된다.
사람들은 중요한 것을 테스트하는 데 집중하는 대신 인공적인 목표를 달성하기 위한 방법을 찾기 시작한다.
적절한 단위 테스트는 이미 충분히 어렵다.
커버리지 숫자를 강요하면 개발자들은 테스트 대상에 신경 쓰지 못하고, 결국 적절한 단위 테스트는 더욱 달성하기 어려워진다.
```
`Tip: 시스템의 핵심 부분은 커버리지를 높게 두는 것이 좋다. 하지만 이 높은 수준을 요구 사항으로 삼는 것은 좋지 않다. 그 차이는 미미하지만 매우 중요하다.`

### 1.4 무엇이 성공적인 테스트 스위트를 만드는가?

```markdown
제대로 하려면 어떻게 해야 할까? 테스트 스위트의 품질을 어떻게 측정해야 하는가?
믿을 만한 방법은 스위트 내 각 테스트를 하나씩 따로 평가하는 것뿐이다.
물론 한 번에 모든 것을 평가할 필요는 없다.
...
성공적인 테스트 스위트는 다음과 같은 특성을 갖고 있다.
- 개발 주기에 통합돼 있다.
- 코드베이스에서 가장 중요한 부분만을 대상으로 한다.
- 최소한의 유지비로 최대의 가치를 끌어낸다.
```

#### 1.4.2 코드베이스에서 가장 중요한 부분만을 대상으로 함

```markdown
대부분의 애플리케이션에서 가장 중요한 부분은 비즈니스 로직(도메인 모델)이 있는 부분이다.
```

#### 1.4.3 최소 유지비로 최대 가치를 끌어냄

```markdown
단위 테스트에서 가장 어려운 부분은 최소 유지비로 최대 가치를 달성하는 것이다.
...
테스트를 빌드 시스템에 통합하는 것만으로는 충분하지 않으며, 도메인 모델에 높은 테스트 커버리지를 유지하는 것도 충분하지 않다.
또한 가치가 유지비를 상회하는 테스트만 스위트에 유지하는 것이 중요하다.
이 마지막 속성은 두 가지로 나눌 수 있다.
- 가치 있는 테스트(더 나아가, 가치가 낮은 테스트) 식별하기
- 가치 있는 테스트 작성하기
```

### 요약

```markdown
- 잘못된 테스트를 가졌거나 테스트 자체가 없는 프로젝트는 모두 똑같이 침체 단계에 있거나 매 릴리스마다 회귀가 많이 생긴다.
- 테스트 스위트 내에 가치가 있는 테스트만 남기고 나머지는 모두 제거하라. 애플리케이션과 테스트 코드는 모두 자산이 아니라 부채다.
- 특정 커버리지 숫자를 부과하면 동기 부여가 잘못된 것이다.
```
