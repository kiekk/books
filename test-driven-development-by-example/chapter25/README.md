## 25장 테스트 주도 개발 패턴

```markdown
어떻게 테스트할 것인가에 대하여 자세히 이야기하기 전에 우선 기본적인 전략에 관한 질문에 답해야 한다.
- 테스트한다는 것은 무엇을 뜻하는가?
- 테스트를 언제 해야 하는가?
- 테스트할 로직을 어떻게 고를 것인가?
- 테스트할 데이터를 어떻게 고를 것인가?
```

### 테스트(명사)

```markdown
작성한 소프트웨어를 어떻게 테스트할 것인가? 자동화된 테스트를 만들어라.
테스트하다(test)는 '평가하다'라는 뜻의 동사다.
그 어떤 소프트웨어 엔지니어도, 아주 확신에 찬 사람과 정말 얼렁뚱땅 넘어가는 사람을 제외한다면, 아무리 작은 변화라도 테스트하지 않고 릴리즈하지는 않는다.
```

### 격리된 테스트

```markdown
테스트를 실행하는 것이 서로 어떤 식으로 영향을 미쳐야 좋은가? 아무 영향이 없어야 한다.
...
어쩄건 주된 교훈은 각각의 테스트는 다른 테스트와 완전히 독립적이어야 한다는 것이다.
즉 문제가 하나면 테스트도 하나만 실패해야 하고, 문제가 둘이면 테스트도 두 개만 실패해야 한다.
격리된 테스트가 암묵적으로 내포하는 특징 중 하나는 테스트가 실행 순서에 독립적이게 된다는 점이다.
테스트의 일부만 실행해보고 싶으면, 선행 테스트가 실행되지 않아서 내가 고른 테스트들이 실패하지 않을까 걱정할 필요 없이 그렇게 할 수 있어야 한다.
성능 문제는 테스트가 데이터를 공유해야 하는 이유로 자주 언급된다.
격리된 테스트가 내포하는 게 또 하나 있는데, 이는 주어진 문제를 작은 단위로 분리하기 위해 노력해서(때론 매우 많은 노력이 필요하다) 각 테스트를 실행하기 위한 
환경을 수비고 빠르게 세팅할 수 있게 해야 한다는 것이다.
테스트를 격리하기 위한 작업은 결과적으로 시스템이 응집도는 높고 결합도는 낮은 객체의 모음으로 구성되도록 한다.
```

### 테스트 목록

```markdown
뭘 테스트해야 하나? 시작하기 전에 작성해야 할 테스트 목록을 모두 적어둘 것.
...
목표에서 벗어나지 않고 집중할 수 있는 한 가지 전략은 모든 걸 머릿속에 넣어 두는 것이다.
이 방법을 몇 년간 시도해본 결과 양성(positive) 피드백 고리에 빠지게 된다는 것을 알게 됐다.
경험이 축적될수록 할일 목록이 많아진다.
성취도가 낮아지면 할일 목록은 더 많아진다.
...
나는 향후 몇 시간 내로 해치워야 하는 모든 할일 목록을 컴퓨터 옆에 있는 종이 조각에 적어놓는 습관을 갖게 됐다.
...
이걸 다 적기만 하면 앞으로는 할일을 놓치지 않게 될 것이다.
새로운 항목이 나타나면 나는 빠르고 의식적으로 이 항목이 '지금' 할일에 속하는지 '나중에' 할일에 속하는지, 또는 할 필요가 없는 일인지를 결정한다.
이를 테스트 주도 개발에 적용해보면, 구현해야 할 것들에 대한 테스트를 목록에 적게 된다.
...
제대로 작동하지 않는 테스트를 하나라도 생각할 수 있다면, 그걸 제대로 되게 하는 것이 코드를 릴리즈하는 것보다 더 중요하다.
```

### 테스트 우선

```markdown
테스트를 언제 작성하는 것이 좋을까? 테스트 대상이 되는 코드를 작성하기 직전에 작성하는 것이 좋다.
```

### 단언 우선

```markdown
테스트를 작성할 때 단언(assert)은 언제쯤 쓸까? 단언을 제일 먼저 쓰고 시작하라.
...
단언을 먼저 작성하면 작업을 단순하게 만드는 강력한 효과를 볼 수 있다.
구현에 대해 전혀 고려하지 않고 테스트만 작성할 때도 사실 여러분은 몇 가지 문제들을 한번에 해결하는 것이다.
```

### 테스트 데이터

```markdown
테스트할 때 어떤 데이터를 사용해야 하는가? 테스트를 읽을 때 쉽고 따라가기 좋을 만한 데이터를 사용하라.
테스트 작성에도 청중이 존재한다.
단지 데이터 값을 산발하기 위해 데이터 값을 산발하지 마라.
데이터 간에 차이가 있다면 그 속에 어떤 의미가 있어야 한다.
1과 2사이에 어떠한 개념적 차이점도 없다면 1을 사용하라.
```

### 명백한 데이터

```markdown
데이터의 의도를 어떻게 표현할 것인가?
테스트 자체에 예상되는 값과 실제 값을 포함하고 이 둘 사이의 관계를 드러내기 위해 노력하라.
테스트를 작성할 때는 컴퓨터뿐 아니라 후에 코드를 읽을 다른 사람들도 생각해야 한다.
수십 년 후 누군가가 와서(혹은 자기가 예전에 만든 코드를 보며) 질문할 것이다.
"대체 이 자식이 뭔 생각으로 이 코드를 만든 거야?" 이 짜증내는 사람이 여러분 자신이 될 수도 있다는 것을 생각하면 코드에 될 수 있는 한 많은 실마리를 남기고 싶을 것이다.
...
명백한 데이터가 주는 또 다른 이점은 프로그래밍이 더 쉬워진다는 것이다.
단언 부분에 일단 수식을 써놓으면 다음으로 무엇을 해야 할지 쉽게 알게 된다.
...
명백한 데이터는 코드에 매직넘버를 쓰지 말라는 것에 대한 예외적인 규칙일 수도 있다.
```
